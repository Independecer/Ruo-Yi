<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.user.mapper.PsyUserIntegralRecordMapper">

    <select id="getList" resultType="com.ruoyi.user.vo.PsyUserIntegralRecordVO">
        select a.id, a.uid, a.link_id, a.link_type, a.type, a.title, a.integral, a.balance, a.mark, a.frozen_time, a.thaw_time, a.del_flag, a.status, a.create_by, a.create_time, a.update_by, a.update_time,
        b.name user_name
        from psy_user_integral_record a
        inner join psy_user b on a.uid = b.id
        <where>
            <if test="uid != null "> and a.uid = #{uid}</if>
            <if test="type != null and type > 0"> and a.type = #{type}</if>
            <if test="keywords != null  and keywords != ''"> and b.name like concat('%', #{keywords}, '%')</if>
            <if test="startTime != null "> and a.create_time <![CDATA[ >= ]]> #{startTime}</if>
            <if test="endTime != null "> and a.create_time <![CDATA[ <= ]]> #{endTime}</if>
            <if test="status != null  and status != ''"> and a.status = #{status}</if>
            <if test="delFlag != null  and delFlag != ''"> and a.del_flag = #{delFlag}</if>
        </where>
    </select>

</mapper>